<!DOCTYPE html>
<html>
  <head>
    <metacharset ="UTF8" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.8.2/css/bulma.min.css"
    />
    <title>経費精算 for Vue.js</title>
  </head>

  <body>
    <div id="app">
      <section class="hero is-info">
        <div class="hero-body">
          <div class="container">
            <h1 class="title">経費精算アプリケーション(Vue.js)</h1>
            <h2 class="subtitle">しょっさん updated @2020/5/29</h2>
          </div>
        </div>
      </section>
      <section class="hero">
        <div class="hero-body">
          <div class="container">
            <div class="tile is-ancestor">
              <div class="tile is-parent">
                <article class="tile is-child box">
                  <router-link to="/login">
                    <button class="button is-link is-rounded" @click="onclick">
                      ログイン
                    </button>
                  </router-link>

                  <router-link to="/expense">
                    <button class="button is-link is-rounded" @click="onclick">
                      経費登録
                    </button>
                  </router-link>

                  <router-link to="/payment">
                    <button class="button is-link is-rounded" @click="onclick">
                      経費精算
                    </button>
                  </router-link>
                </article>
              </div>
            </div>
            <router-view></router-view>
          </div>
        </div>
      </section>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.11"></script>
    <script src="https://unpkg.com/vue-router@3.3.2/dist/vue-router.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="./jwt-decode.min.js"></script>

    <script type="text/x-template" id="login">
      <div class="container">
          <div class="container has-text-centered">
              <div class="column is-4 is-offset-4">
                  <h3 class="title has-text-black">ログイン</h3>
                  <hr class="login-hr">
                  <p class="subtitle has-text-black">経費精算を行うには、ログインしてください</p>
                  <div class="box">
                      <figure class="avatar">
                          <img src="https://placehold.it/128x128">
                      </figure>
                      <form @submit.prevent="login">
                          <div class="field">
                              <div class="control">
                                  <input class="input is-mideum" v-model="user" type="email" placeholder="Your Email" autofocus="">
                              </div>
                          </div>

                          <div class="field">
                              <div class="control">
                                  <input class="input is-midium" v-model="password" type="password" placeholder="Your Password">
                              </div>
                          </div>
                          <div class="field">
                              <label class="checkbox">
                                <input v-model="remember" type="checkbox">Remember me</input>
                              </label>
                          </div>
                          <button class="button is-block is-info is-large is-fullwidth" @onclick="Login()" type="submit">ログイン<i class="fa fa-sign-in" aria-hidden="true"></i></button>
                      </form>
                  </div>
              </div>
          </div>
        </div>
        <article v-if="error" class="message is-danger">
          <div class="message-header">
            <p>ログイン失敗</p>
            <button class="delete" aria-label="delete"></button>
          </div>
          <div class="message-body">
            入力されたメールアドレスか、パスワードがまちがっています
          </div>
        </article>
    </script>

    <script type="text/x-template" id="payment">
      <div class="container">
        <table class="table">
          <th>#</th>
          <th>ユーザー名</th>
          <th>発生日</th>
          <th>費目</th>
          <th>経費</th>
          <th>詳細</th>
          <tr v-for="(payment, i) in payments" :key="payment.user_id">
            <td>{{i + 1}}</td>
            <td>{{payment.user_name}}</td>
            <td>{{payment.date}}</td>
            <td>{{payment.type}}</td>
            <td>{{payment.amount}}</td>
            <td>{{payment.description}}</td>
          </tr>
        </table>
        <div class="loading" v-if="loading">アクセス中...</div>
      </div>
    </script>

    <script type="text/x-template" id="expense">
      <div class="container">経費精算</div>
    </script>

    <script src="./index.js"></script>
  </body>
</html>
